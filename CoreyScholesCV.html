<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.17">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Corey Scholes, PhD">
<meta name="dcterms.date" content="2025-10-16">

<title>Curiculum Vitae</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="CoreyScholesCV_files/libs/clipboard/clipboard.min.js"></script>
<script src="CoreyScholesCV_files/libs/quarto-html/quarto.js"></script>
<script src="CoreyScholesCV_files/libs/quarto-html/popper.min.js"></script>
<script src="CoreyScholesCV_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="CoreyScholesCV_files/libs/quarto-html/anchor.min.js"></script>
<link href="CoreyScholesCV_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="CoreyScholesCV_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="CoreyScholesCV_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="CoreyScholesCV_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="CoreyScholesCV_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


<link rel="stylesheet" href="cv.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#professional-experience" id="toc-professional-experience" class="nav-link active" data-scroll-target="#professional-experience">Professional EXPERIENCE</a>
  <ul class="collapse">
  <li><a href="#co-founder-and-director" id="toc-co-founder-and-director" class="nav-link" data-scroll-target="#co-founder-and-director">Co-Founder and Director</a></li>
  <li><a href="#chief-science-officer" id="toc-chief-science-officer" class="nav-link" data-scroll-target="#chief-science-officer">Chief Science Officer</a></li>
  <li><a href="#director-of-research" id="toc-director-of-research" class="nav-link" data-scroll-target="#director-of-research">Director of Research</a></li>
  <li><a href="#army-officer" id="toc-army-officer" class="nav-link" data-scroll-target="#army-officer">Army Officer</a></li>
  <li><a href="#teaching-assistant" id="toc-teaching-assistant" class="nav-link" data-scroll-target="#teaching-assistant">Teaching Assistant</a></li>
  <li><a href="#research-assistant" id="toc-research-assistant" class="nav-link" data-scroll-target="#research-assistant">Research Assistant</a></li>
  </ul></li>
  <li><a href="#skills" id="toc-skills" class="nav-link" data-scroll-target="#skills">SKILLS</a></li>
  <li><a href="#scientific-output" id="toc-scientific-output" class="nav-link" data-scroll-target="#scientific-output">SCIENTIFIC OUTPUT</a>
  <ul class="collapse">
  <li><a href="#key-methodological-innovations" id="toc-key-methodological-innovations" class="nav-link" data-scroll-target="#key-methodological-innovations"><strong>Key Methodological Innovations:</strong></a></li>
  <li><a href="#notable-multi-stakeholder-projects" id="toc-notable-multi-stakeholder-projects" class="nav-link" data-scroll-target="#notable-multi-stakeholder-projects"><strong>Notable Multi-Stakeholder Projects:</strong></a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">REFERENCES</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="CoreyScholesCV.docx"><i class="bi bi-file-word"></i>MS Word</a></li><li><a href="CoreyScholesCV.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Curiculum Vitae</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Corey Scholes, PhD </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 16, 2025</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">October 10, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<p><strong>Scientist and Analysis Executive</strong> with 15 years of experience bridging the gap between clinical research and evidence-generation with routine practice across diverse settings. A collaborative leader with the ability to communicate technically across multidisciplinary teams and influence behaviour change to embed data-driven practices into long-term strategies. An experienced consultant assisting executive teams to bring about change within their own organisations through strategic planning and implementation of complex systems.</p>
<section id="professional-experience" class="level2" style="page-break-before: always">
<h2 style="page-break-before: always" class="anchored" data-anchor-id="professional-experience">Professional EXPERIENCE</h2>
<section id="co-founder-and-director" class="level3">
<h3 class="anchored" data-anchor-id="co-founder-and-director">Co-Founder and Director</h3>
<p><a href="www.ebmanalytics.com.au">EBM Analytics</a> <span class="cvdate"><em>Jul 2016 - Present</em></span></p>
<ul>
<li>Built a profitable healthcare analytics firm from ground up, scaling from solo consultant to $750K+ annual revenue with 10 FTE staff</li>
<li>Established a national and international client base across public and private health sectors, government, and industry.</li>
<li>Secured numerous consulting engagements resulting in peer-reviewed publications and internal organisation reports</li>
<li>Drove business development strategy through targeted account acquisition and relationship management with complex stakeholder ecosystems</li>
</ul>
<p><strong>System Architecture &amp; Implementation</strong></p>
<ul>
<li><strong>Designed and deployed 8+ specialist clinical quality registries</strong> for sports medicine, joint arthroplasty, and oncology, managing projects valued at $50K-$200K each, with ongoing partnerships of 5+ years</li>
<li><strong>Served as lead technical architect</strong> for SHARKS (public hospital orthopaedics), CROSEP and PRULO (upper limb outcomes), COMPRESSOR (complex pelvis and limb reconstruction), SOFARI (foot and ankle), PROKPATH (knee), AORA (hip and knee arthroplasty) and PROPELLER (orthopaedics) registries</li>
<li><strong>Implemented sophisticated data infrastructure</strong> integrating electronic screening, randomization, and longitudinal patient-reported outcome collection within clinical workflows</li>
<li><strong>Ensured regulatory compliance</strong> with Australian Commission on Safety and Quality in Health Care principles for clinical quality registries and human research ethics requirements</li>
</ul>
<p><strong>Methodological Excellence &amp; Quality Assurance</strong></p>
<ul>
<li><p><strong>Oversee analysis of complex datasets</strong> including public hospital presentations (100K+ episodes), longitudinal cohort studies (20 000+ records), and registry-embedded randomized controlled trials (</p></li>
<li><p><strong>Implement advanced statistical methods</strong> including meta-analysis/meta-regression, natural language processing for clinical text data, k-means clustering for patient phenotyping, and predictive modeling with external validation</p></li>
<li><p><strong>Ensure compliance</strong> with CONSORT, STROBE, PRISMA, and IDEAL frameworks for surgical innovation reporting</p></li>
</ul>
<p><strong>Team Leadership &amp; Capacity Building</strong></p>
<ul>
<li><p><strong>Supervise multidisciplinary teams</strong> of engineers, data analysts, clinicians, and research coordinators across concurrent projects</p></li>
<li><p><strong>Mentor staff development</strong> in advanced statistical programming, study design, regulatory compliance, and scientific writing</p></li>
<li><p><strong>Established quality systems</strong> for data validation, analysis verification, and peer review of outputs</p></li>
</ul>
</section>
<section id="chief-science-officer" class="level3">
<h3 class="anchored" data-anchor-id="chief-science-officer">Chief Science Officer</h3>
<p><a href="www.ebmanalytics.com.au">EBM Analytics</a> <span class="cvdate"><em>2020 - Present</em></span></p>
<ul>
<li>Provide scientific leadership to clinical research projects and engagements in which the company is involved.</li>
<li>Represent the companyâ€™s interests in the establishment of strategic partnerships and collaborations.</li>
<li>Develop and implement research strategy for clientele.</li>
<li>Offer guidance on methodological approaches to ensure high-quality research outputs.</li>
<li>Collaborate with clients, clinicians, researchers, and other stakeholders to understand stakeholder requirements, provide scientific guidance, and communicate project results effectively.</li>
<li>Develop and maintain a deep understanding of various research methodologies, including clinical trials, observational studies, health outcomes, health services and systematic review/meta-analysis research.</li>
<li>Lead the analysis and interpretation of complex data sets, including clinical registry data, providing actionable insights to clients and stakeholders while ensuring regulatory compliance with relevant guidelines and industry standards.</li>
<li>Oversee engineers, analysts, and clinicians, providing guidance internally and externally to the company on project management, data analysis, and output preparation.</li>
</ul>
</section>
<section id="director-of-research" class="level3">
<h3 class="anchored" data-anchor-id="director-of-research">Director of Research</h3>
<p><a href="www.sori.com.au">Sydney Orthopaedic Research Institute</a> <span class="cvdate"><em>2009 - 2016</em></span></p>
<ul>
<li>Plan, lead and manage research activities within the Institute.</li>
<li>Develop research strategy in consultation with Institute Directors.</li>
<li>Conduct regular reporting to the Board on research, project and operational activities of the Institute.</li>
<li>Contribute to financial planning, monitoring and reporting.</li>
<li>Offer guidance on methodological approaches to ensure high-quality research outputs.</li>
<li>Provide close assistance to clinician researchers in the preparation of presentations and research articles.</li>
<li>Act as primary point of contact for staffing, contracting and supplier engagements.</li>
<li>Champion transition of IT infrastructure to updated and upgraded software and hardware to support growing operational load.</li>
</ul>
</section>
<section id="army-officer" class="level3">
<h3 class="anchored" data-anchor-id="army-officer">Army Officer</h3>
<p>Australian Army Reserve <span class="cvdate"><em>2009 - 2015</em></span></p>
<ul>
<li>Responsible for the training, administration and leadership of up to 50 personnel</li>
<li>Provide command presence and tactical leadership during simulated and live-fire infantry training exercises and ceremonial activities.</li>
<li>Train, mentor and develop team leaders under command, including the planning and conduct of training activities specific to their development.</li>
<li>Directly contribute to soldier training through presentation and demonstration in classroom and field environments.</li>
<li>Coordinate enabling elements to support training activities and simulated combat operations.</li>
<li>Contribute to command activities in collaboration with Senior Management within joint planning, budgeting and personnel administration.</li>
<li>Coordinated multi-unit operations supporting training activities and simulated combat operations for 600+ personnel. Contributed to strategic planning including operational risk management, budgeting, and personnel administration in collaboration with senior command.</li>
</ul>
</section>
<section id="teaching-assistant" class="level3">
<h3 class="anchored" data-anchor-id="teaching-assistant">Teaching Assistant</h3>
<p><a href="www.qut.edu.au">Queensland University of Technology</a> <span class="cvdate"><em>2006 - 2008</em></span></p>
<ul>
<li>Plan, prepare and deliver lectures on fundamental and advanced biomechanics and functional anatomy.</li>
<li>Conduct syllabus planning and preparation for semester units and the fundamental and advanced levels.</li>
<li>Conduct tutorial sessions to develop student practical skills in movement analysis and exercise prescription.</li>
</ul>
</section>
<section id="research-assistant" class="level3">
<h3 class="anchored" data-anchor-id="research-assistant">Research Assistant</h3>
<p><a href="www.qut.edu.au">Queensland University of Technology</a> <span class="cvdate"><em>2004 - 2005</em></span></p>
<ul>
<li>Assist with research projects on worker health in the coal mining industry.</li>
<li>Prepare research output materials for presentations and government reports on the state-of-the-art in worker health within the industry</li>
<li>Contribute to on-site measurements of contractors in active coal mines within the Central Highlands of Queensland.</li>
</ul>
</section>
</section>
<div class="columns">
<div class="column">
<section id="education" class="level1">
<h1>EDUCATION</h1>
<p><strong>Doctor of Philosophy â€“ Exercise Science</strong> <br> <em>Queensland University of Technology</em> <span class="cvdate"><em>Feb 2005 â€” Oct 2010</em></span></p>
<ul>
<li><a href="https://eprints.qut.edu.au/39314/">The effects of fatigue on knee function during landing</a></li>
<li>Vice-Chancellor Scholarship (2005-2008)</li>
<li>Supervisors
<ul>
<li>Dr Michael D McDonald</li>
<li>Prof Anthony W Parker</li>
</ul></li>
</ul>
<p><strong>BApp Sci (Hons)</strong> <br> <em>Queensland University of Technology</em> <span class="cvdate"><em>2004</em></span></p>
<p><strong>BApp Sci (Human Movement Studies)</strong> <br> <em>Queensland University of Technology</em> <span class="cvdate"><em>2001 - 2003</em></span></p>
</section>
<section id="credentials" class="level1">
<h1>CREDENTIALS</h1>
<ul>
<li>Good Clinical Practice</li>
<li>Working With Children Check</li>
</ul>
</section>
</div><div class="column">
<section id="memberships" class="level1">
<h1>MEMBERSHIPS</h1>
<ul>
<li>International Society for Arthroscopy and Knee Orthopaedic Surgery</li>
<li>Australian Institute of Company Directors</li>
<li>Australia and New Zealand Orthopaedic Research Society (Past)</li>
</ul>
</section>
</div>
</div>
<section id="skills" class="level1">
<h1>SKILLS</h1>
<div class="columns">
<div class="column">
<section id="technical" class="level2">
<h2 class="anchored" data-anchor-id="technical">Technical</h2>
<section id="strategic-analytics-methodology" class="level3">
<h3 class="anchored" data-anchor-id="strategic-analytics-methodology">Strategic Analytics &amp; Methodology</h3>
<ul>
<li><p><strong>Advanced Statistical Modeling:</strong> Prediction &amp; inference modeling, machine learning (k-means clustering, phenotyping), survival analysis, multistate modeling, meta-analysis/meta-regression</p></li>
<li><p><strong>Causal Inference:</strong> Directed Acyclic Graphs (DAGs), systematic confounder selection, propensity score methods</p></li>
<li><p><strong>Clinical Trials:</strong> Design, conduct, and reporting (CONSORT, IDEAL framework)</p></li>
<li><p><strong>Registry Science:</strong> Clinical quality registry design, implementation, validation, and reporting</p></li>
<li><p><strong>Health Services Research:</strong> Model of care evaluation, length-of-stay prediction, external validation of clinical prediction models</p></li>
<li><p><strong>Technical analysis:</strong> Analysis of anatomy and biomechanics relevant to surgical, rehabilitation and diagnostic applications of musculoskeletal conditions</p></li>
</ul>
</section>
<section id="data-engineering-computing" class="level3">
<h3 class="anchored" data-anchor-id="data-engineering-computing">Data Engineering &amp; Computing</h3>
<ul>
<li><p><strong>Languages &amp; Environments:</strong> R, RStudio, Quarto, Stata, Minitab, Matlab, SQL, Google Query, Regular expressions</p></li>
<li><p><strong>Cloud &amp; Infrastructure:</strong> Google Cloud Platform (LookerStudio, App Scripts)</p></li>
<li><p><strong>Modern Data Science Stack:</strong> tidyverse (data manipulation), gtsummary and ggplot2 (visualisation and presentation), mice (multiple imputation), marginaleffects (model interpretation)</p></li>
<li><p><strong>Specialized Analytics:</strong> Natural language processing, signal processing, time series analysis</p></li>
<li><p><strong>Version Control &amp; Project Management:</strong> Git, ClickUp</p></li>
</ul>
</section>
<section id="regulatory-governance" class="level3">
<h3 class="anchored" data-anchor-id="regulatory-governance">Regulatory &amp; Governance</h3>
<ul>
<li><p>Good Clinical Practice</p></li>
<li><p>Human research ethics application, management and liaison experience</p></li>
<li><p>Clinical quality registry compliance (ACSQHC principles)</p></li>
<li><p>Working With Children Check</p></li>
</ul>
</section>
</section>
</div><div class="column">
<section id="non-technical" class="level2">
<h2 class="anchored" data-anchor-id="non-technical">Non-Technical</h2>
<section id="business-organizational-leadership" class="level3">
<h3 class="anchored" data-anchor-id="business-organizational-leadership"><strong>Business &amp; Organizational Leadership</strong></h3>
<ul>
<li><p>Strategic planning and execution</p></li>
<li><p>Business development and account management</p></li>
<li><p>Financial planning, monitoring, and P&amp;L responsibility</p></li>
<li><p>Change management and organizational transformation</p></li>
<li><p>Stakeholder engagement across complex ecosystems</p></li>
</ul>
<p><strong>Technical &amp; Scientific Leadership</strong></p>
<ul>
<li><p>Research strategy development and implementation</p></li>
<li><p>Methodological innovation and thought leadership</p></li>
<li><p>Quality assurance and regulatory compliance</p></li>
<li><p>Team building and talent development</p></li>
<li><p>Cross-functional collaboration</p></li>
</ul>
<p><strong>Core Professional Skills</strong></p>
<ul>
<li><p>Public speaking and executive communication</p></li>
<li><p>Problem-solving and adaptive thinking</p></li>
<li><p>Conflict resolution and negotiation</p></li>
<li><p>Risk assessment and mitigation</p></li>
<li><p>Long-term strategic planning</p></li>
</ul>
</section>
</section>
</div>
</div>
</section>
<section id="scientific-output" class="level1">
<h1>SCIENTIFIC OUTPUT</h1>
<p>80+ peer-reviewed publications spanning meta-science, surgical and allied health outcomes in musculoskeletal medicine, clinical quality registries, predictive modeling, clinical trials, population health, and health services research. A summary of my research output is available at <a href="https://scholar.google.com.au/citations?user=PKsLEVQAAAAJ&amp;hl=en">Google Scholar</a> (h-index 21) and <a href="https://orcid.org/0000-0001-6592-0738">Orcid.org</a>. My summary <a href="https://drive.google.com/file/d/1-3km47uPpoYbxgskkXc6kdgOhtD2Pk5U/view?usp=sharing">profile</a> from Publons (Web of Science) also illustrates my contributions to peer-review with respected journals within my field. Selected citations to illustrate my experience in key science domains are summarised below, including preprint articles that have yet to be submitted for peer review.</p>
<section id="key-methodological-innovations" class="level2">
<h2 class="anchored" data-anchor-id="key-methodological-innovations"><strong>Key Methodological Innovations:</strong></h2>
<ul>
<li><p>Development of innovative registry methods for implementation of efficient monitoring of health outcomes into local systems</p></li>
<li><p>Application of causal inference methods to observation research in medical and health services research</p></li>
<li><p>Multistate survival modeling for complex adverse events in surgical cohorts</p></li>
<li><p>Machine learning phenotyping of patient cohorts and technical analysis of musculoskeletal anatomy</p></li>
<li><p>Registry-embedded randomized controlled trial methodology</p></li>
</ul>
</section>
<section id="notable-multi-stakeholder-projects" class="level2">
<h2 class="anchored" data-anchor-id="notable-multi-stakeholder-projects"><strong>Notable Multi-Stakeholder Projects:</strong></h2>
<ul>
<li><p>Industry-sponsored device innovation evaluations balancing scientific rigor with commercial considerations</p></li>
<li><p>Public-private partnerships establishing clinical registries across hospital systems</p></li>
<li><p>National registry analysis of patient travel patterns and outcomes (AOANJRR collaboration)</p></li>
<li><p>Analysis of public health data involving linkage with local and state data sets</p></li>
</ul>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">REFERENCES</h2>
<p>Available upon request</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>